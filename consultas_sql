
CONSULTAS

	1) DADO UM ID DE LIVRO, EXIBIR OS EXEMPLARES DISPONÍVEIS PARA LOCAÇÃO E AS RESPECTIVAS SEÇÕES E BIBLIOTECAS.
		UTILIDADE: AUXILIAR O USUÁRIO A ENCONTRAR O LIVRO DENTRO DO GRUPO DE BIBLIOTECAS

SELECT 
    l.titulo,
    b.nome as biblioteca,
    s.nome as secao,
    count(e.id) as quantidade_disponivel
FROM
    biblioteca b
    left outer join secao_biblioteca sb on sb.biblioteca_id = b.id
    left outer join secao s on sb.secao_id = s.id
    left outer join exemplar e on e.secao_biblioteca_id = sb.id
    left outer join livro l on e.livro_id = l.id
WHERE
    l.id = 1
    and e.status = 'devolvido'
GROUP BY
    b.id
ORDER BY
    quantidade_disponivel DESC



	2) VALOR TOTAL DA MULTA DEVIDA POR DETERMINADO USUÁRIO AO GRUPO DE BIBLIOTECAS, DISCRIMINANDO O TOTAL DEVIDO PARA CADA BIBLIOTECA. (GROUP BY)
		UTILIDADE: PERMITIR QUE QUALQUER BIBLIOTECA DO GRUPO FORNEÇA UMA CERTIDAO DE NADA CONSTA AO USUÁRIO, CASO ELE NÃO ESTEJA EM DÉBITO

	3) QUAL A MÉDIA DE IDADE DOS USUÁRIOS QUE PEGARAM DETERMINADO LIVRO? (AVG)
		UTILIDADE: LEVANTAMENTO DE PREFERENCIAS/PERFIL DOS USUÁRIOS

	4) USUÁRIOS COM RESERVA ATIVA PARA DETERMIANDO LIVRO EM DETERMINADA BIBLIOTECA, ORDENADOS POR DATA DE RESERVA. (ORDER BY)
		UTILIDADE: AVISAR O USUÁRIO DO TOPO DA LISTA ASSIM QUE O LIVRO ESTIVER DISPONÍVEL NA BIBLIOTECA.

	5) VALOR RECEBIDO POR DETERMIANDO FUNCIONARIO EM DETERMINADO DIA. (SUM)
		UTILIDADE: PRESTAÇÃO DE CONTAS DO VALOR RECEBIDO DURANTE O DIA.

	6) TOP 5 EDITORAS DO GRUPO (CONSIDERANDO EMPRÉSTIMOS DE SEUS LIVROS NO ÚLTIMO ANO).
		UTILIDADE: VERIFICAR QUAIS SÃO AS EDITORAS QUE FORNECEM OS LIVROS QUE MAIS AGRADAM OS USUÁRIOS

	7) VALOR TOTAL DO ACERVO DA BIBLIOTECA. (SUM)
		UTILIDADE: BALANÇO PATRIMONIAL
		
	8)  DADO UM ID DE USUÁRIO, RETORNAR OS EMPRÉSTIMOS ATIVOS DO USUÁRIO, INDICANDO NOME DO LIVRO, CÓDIGO DO EXEMPLAR, DATA DE EMPRESTIMO, DATA PREVISTA DE DEVOLUÇÃO E NOME DA BIBLIOTECA.
		UTILIDADE: FORNECER ESTAS INFORMAÇÕES NO PORTAL DO USUÁRIO, PARA QUE ELE TENHA CONTROLE DOS PRAZOS DE CADA EMPRESTIMO
	
SELECT
    u.nome as usuario,
    l.titulo as livro,
    ex.id as exemplar_id,
    e.data_emprestimo as data_emprestimo,
    adddate(e.data_emprestimo, INTERVAL b.emprestimo_dias day) as data_prevista_devolucao,
    b.nome as biblioteca
FROM
    emprestimo e
    left outer join usuario u on e.usuario_id = u.id
    left outer join exemplar ex on e.exemplar_id = ex.id
    left outer join livro l on ex.livro_id = l.id
    left outer join secao_biblioteca sb on ex.secao_biblioteca_id = sb.id
    left outer join biblioteca b on sb.biblioteca_id = b.id
WHERE
    u.id = 3
    and e.data_devolucao is null
ORDER BY
    l.titulo	
	
	
		
	9) DADO UM LIVRO, RETORNAR A QUANTIDADE DE DIAS EM QUE O MESMO PERMANECEU EMPRESTADO E QUANTOS PERMANECEU NA PRATELEIRA.
		UTILIDADE: VERIFICAR POSSIBILIDADE DE ENVIAR LIVRO PARA SEÇÃO "MORTA"
	
	10) DADO UM ID DE USUÁRIO, RETORNAR UMA LISTA COM TODAS AS SEÇÕES DE LIVROS QUE O USUÁRIO JÁ PEGOU, ORDENADAS POR NÚMERO DE EMPRÉSTIMOS REALIZADOS PARA ESTE USUÁRIO
		UTILIDADE: VERIFICAR AS SEÇÕES PREFERIDAS E FORNECER SUGESTÕES DE OUTROS LIVROS

SELECT
    s.nome as secao,
    count(e.id) as emprestimos_realizados
FROM
    secao s
    left outer join secao_biblioteca sb on sb.secao_id = s.id
    left outer join exemplar ex on ex.secao_biblioteca_id = sb.id
    left outer join emprestimo e on e.exemplar_id = ex.id
    left outer join usuario u on e.usuario_id = u.id
WHERE
    u.id = 3
GROUP BY
    s.id
ORDER BY
    count(e.id) DESC
	

	
	11) DADO UM CONJUNTO DE PALAVRAS-CHAVE, RETORNAR OS LIVROS QUE CONTÉM AO MENOS UMA DELAS
		UTILIDADE: PESQUISA DE LIVROS

SELECT
    l.titulo as livro,
    l.ano as ano,
    e.nome as editora,
    pc.palavra as palavra
FROM
    livro l
    left outer join editora e on l.editora_id = e.id
    left outer join palavra_chave_livro pcl on pcl.livro_id = l.id
    left outer join palavra_chave pc on pcl.palavra_chave_id = pc.id
WHERE
    pc.palavra in ('leão', 'informação')
ORDER BY 
    l.titulo ASC


		
	12) DADA UM ID DE BIBLIOTECA, RETORNAR O NOME DOS LIVROS QUE FORAM EMPRESTADOS NA DATA ATUAL E SUAS RESPECTIVAS QUANTIDADES
		UTILIDADE: AUDITORIA DE EMPRÉSTIMOS

SELECT
    u.nome as usuario,
    l.titulo as livro,
    ex.id as exemplar_id,
    e.data_emprestimo as data_emprestimo,
    adddate(e.data_emprestimo, INTERVAL b.emprestimo_dias day) as data_prevista_devolucao
FROM
    emprestimo e
    left outer join usuario u on e.usuario_id = u.id
    left outer join exemplar ex on e.exemplar_id = ex.id
    left outer join livro l on ex.livro_id = l.id
    left outer join secao_biblioteca sb on ex.secao_biblioteca_id = sb.id
    left outer join biblioteca b on sb.biblioteca_id = b.id
WHERE
    u.id = 3
ORDER BY
    l.titulo


		
	13) QUANTIDADE DE FUNCIONÁRIOS POR BIBLIOTECA
		UTILIDADE: BALANÇO
	
	14) QUANTIDADE DE LIVROS POR BIBLIOTECA
		UTILIDADE: BALANÇO PATRIMONIAL
	
	15) BIBLIOTECA MAIS POPULAR (MÉDIA DE EMPRÉSTIMOS POR USUÁRIO, OU SEJA, QUANT. DE EMPRESTIMOS / QUANT. DE USUÁRIOS)
		UTILIDADE: ESTATÍSTICAS - COMPARAR AS BIBLIOTECAS DO GRUPO 

